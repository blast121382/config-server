server:
    port: ${CUSTOM.SERVER.PORT:9090}
eureka:
    instance:
     prefer-ip-address: true
     lease-expiration-duration-in-seconds: 30
    client:
        register-with-eureka: true
        service-url:
            defaultZone: ${EUREKA.SERVER.HOSTNAME:http://localhost:8761/eureka}
        fetchRegistry: true
resilience4j:
 circuitbreaker:
  configs:
   mitocodeCircuitbreakerProduct:
    slidingWindowSize: 20
    failureRateThreshold: 75
    waitDurationInOpenState: 30s
    permittedNumberOfCallsInHalfOpenState: 10
    slowCallDurationThreshold: 2s
    slowCallRateThreshold: 10
  instances:
   product-cb:
    base-config: mitocodeCircuitbreakerProduct
 timelimiter:
  configs:
   mitocodeTimeLimiterProduct:
    timeoutDuration: 1s
  instances:
   product-time:
    base-config: mitocodeTimeLimiterProduct
    
spring:
 cloud:
  gateway:
   routes:
    - id: user-service
      uri: lb://user-service
      predicates:
       - Path=/api/user-services/**
      filters:
       - StripPrefix=2
       - MitocodeFilter=MitocodeKey,MitocodeValue
    - id: product-service
      uri: lb://product-service
      predicates:
       - Path=/api/product-services/**
      filters:
       - StripPrefix=2
       #- AddRequestParameter=tokens,mitocode
       #- AddRequestHeader=token,mitocode
       #- AddResponseHeader=CUSTOM_RESPONSE_HEADER,HEADER_mitocode
       - MitocodeFilter=Mitocode,MitocodeValue
       #- name: CustomFilter
       #  args:
       #   headerKey: MitocodeKey
       #   headerValue: MitocodeValue
       - name: CircuitBreaker
         args:
          name: product-cb
          statusCodes: 400, 401, 403, 404, 500, 503, 504
      #    fallbackUri: forward:/api/user-services/user

logging:
 level:
  org:
   springframework:
    cloud:
     gateway: DEBUG
     
mitocode:
 security:
  client: clientMitocode
  secret: secretMitocode
  signKey: 9f7f6b91a2fbb33327fff07554e013dbaf653f193a9e995f62ef105524effebbd132bf7a94231a9465477adea288725d87e974339f7fbe3b1ed88919eeb86d909d9946be95d1a7820b37956f9203db07328de8840ceb2141495bae40bd623eb581589b5f7ed6d25c39160ee3fe0a4a164af84ce09b047db157429f819e1b840901ecfb6038fac0cb13b55f9d9fcabb7c3bbe040ea4c5dc6f0abe9b1db907d1c16b72166a78e339d790735683b0d3389c8452d2f26f560d7736fe58f2422cecf7034af724126022b991b1bdbc81f43fba525e568b8619e98a23ed57b6dd17af07
